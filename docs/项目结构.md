# Goodsop 项目结构文档

## 项目概述
Goodsop是一个基于Spring Boot 3.1.5和Java 17构建的多模块项目，提供RESTful API服务。项目整合了MyBatis-Plus和PostgreSQL数据库，实现了文件上传、下载和管理等功能。

## 技术栈
- **框架**: Spring Boot 3.1.5
- **JDK版本**: Java 17
- **ORM框架**: MyBatis-Plus 3.5.3.2
- **数据库**: PostgreSQL 42.6.0
- **数据库连接池**: Druid 1.2.20
- **API文档**: Knife4j 4.3.0 (基于OpenAPI 3.0)
- **工具库**: Hutool 5.8.23
- **日志**: SLF4J (Spring Boot集成)
- **测试**: JUnit 5.10.0, Mockito 5.6.0

## 项目结构

```
goodsop3/
├── docs/                             # 项目文档
│   ├── file模块需求.md               # 文件模块需求文档
│   ├── 开发指南.md                   # 开发指南
│   ├── Knife4j文档配置指南.md        # Knife4j配置指南
│   ├── SpringBoot多模块项目构建指南.md # 多模块项目构建指南
│   ├── 框架调整变更记录.md            # 框架变更记录
│   ├── 框架开发文档.md                # 框架开发文档
│   └── 项目结构.md                    # 本文档
├── goodsop-common/                   # 公共模块
│   ├── src/main/java/com/goodsop/common/
│   │   ├── aop/                      # AOP相关类
│   │   │   ├── LogAspect.java        # 日志切面
│   │   │   └── WebLogProperties.java # Web日志配置属性
│   │   ├── config/                   # 公共配置
│   │   │   ├── JacksonConfig.java    # Jackson配置
│   │   │   └── LoggingConfig.java    # 日志配置
│   │   └── core/                     # 核心组件
│   │       └── model/                # 公共模型
│   │           └── Result.java       # 统一返回结果
│   └── pom.xml                       # 公共模块POM
├── goodsop-config/                   # 配置模块
│   ├── src/main/resources/           # 配置资源
│   │   ├── application.yml           # 主配置文件
│   │   ├── application-dev.yml       # 开发环境配置
│   │   ├── application-test.yml      # 测试环境配置
│   │   └── application-prod.yml      # 生产环境配置
│   └── pom.xml                       # 配置模块POM
├── goodsop-file/                     # 文件模块
│   ├── src/
│   │   ├── main/java/com/goodsop/file/
│   │   │   ├── config/               # 模块配置
│   │   │   ├── constant/             # 常量定义
│   │   │   ├── controller/           # 控制器
│   │   │   │   ├── FileDownloadController.java  # 文件下载控制器
│   │   │   │   ├── FileManageController.java    # 文件管理控制器
│   │   │   │   └── FileUploadController.java    # 文件上传控制器
│   │   │   ├── entity/               # 实体类
│   │   │   │   └── FileInfo.java     # 文件信息实体
│   │   │   ├── mapper/               # MyBatis映射器
│   │   │   │   └── FileInfoMapper.java  # 文件信息Mapper
│   │   │   ├── service/              # 服务接口
│   │   │   │   ├── FileService.java     # 文件服务接口
│   │   │   │   └── impl/
│   │   │   │       └── FileServiceImpl.java  # 文件服务实现
│   │   │   └── util/                 # 工具类
│   │   │       ├── FileCompressUtil.java  # 文件压缩工具
│   │   │       ├── FileEncryptUtil.java   # 文件加密工具
│   │   │       └── FileTransferUtil.java  # 文件传输工具
│   │   └── test/java/com/goodsop/file/
│   │       └── util/                 # 工具类测试
│   │           ├── FileCompressUtilTest.java  # 压缩工具测试
│   │           ├── FileEncryptUtilTest.java   # 加密工具测试
│   │           └── FileTransferUtilTest.java  # 传输工具测试
│   └── pom.xml                       # 文件模块POM
├── goodsop-iot/                      # IoT模块(待开发)
│   ├── src/                          # 源代码目录
│   └── pom.xml                       # IoT模块POM
├── goodsop-user/                     # 用户模块
│   ├── src/
│   │   ├── main/java/com/goodsop/user/
│   │   │   ├── config/               # 模块配置
│   │   │   ├── controller/           # 用户控制器
│   │   │   ├── entity/               # 用户实体
│   │   │   ├── mapper/               # 用户Mapper
│   │   │   └── service/              # 用户服务
│   │   └── test/java/com/goodsop/user/
│   │       └── service/
│   │           └── UserServiceTest.java  # 用户服务测试
│   └── pom.xml                       # 用户模块POM
├── goodsop-server/                   # 服务器模块
│   ├── src/main/java/com/goodsop/server/
│   │   ├── config/                   # 服务器配置
│   │   ├── controller/               # 全局控制器
│   │   └── GoodsopApplication.java   # 应用程序启动类
│   └── pom.xml                       # 服务器模块POM
├── logs/                             # 日志目录
└── pom.xml                           # 项目根POM
```

## 模块说明

### 1. goodsop-common (公共模块)
提供系统公共组件和工具，包括：
- AOP日志处理
- 全局异常处理
- 通用返回结果
- 核心配置类

### 2. goodsop-config (配置模块)
集中管理应用程序的各种配置，支持不同环境（开发、测试、生产）：
- application.yml：主配置文件，设置通用配置和激活环境
- application-dev.yml：开发环境配置
- application-test.yml：测试环境配置
- application-prod.yml：生产环境配置

### 3. goodsop-file (文件模块)
实现文件上传、下载和管理功能：
- 支持断点续传
- 文件加密/解密
- 文件压缩/解压
- 文件元数据管理

文件模块主要组件：
- **控制器**: 提供RESTful API接口
- **服务**: 实现业务逻辑
- **工具类**: 实现文件操作功能
- **测试类**: 验证功能正确性

### 4. goodsop-iot (IoT模块)
实现IoT设备管理功能（待开发）。

### 5. goodsop-user (用户模块)
实现用户管理功能：
- 用户注册与登录
- 用户信息管理
- 权限控制

### 6. goodsop-server (服务器模块)
应用程序入口，包含启动类和服务器配置：
- 全局配置
- 统一入口点
- 集成各模块功能

## 技术依赖版本
项目根POM中已定义的依赖版本：
```xml
<properties>
    <java.version>17</java.version>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
    <spring-boot.version>3.1.5</spring-boot.version>
    <mybatis-plus.version>3.5.3.2</mybatis-plus.version>
    <druid.version>1.2.20</druid.version>
    <postgresql.version>42.6.0</postgresql.version>
    <knife4j.version>4.3.0</knife4j.version>
    <hutool.version>5.8.23</hutool.version>
    <lombok.version>1.18.30</lombok.version>
    <junit.version>5.10.0</junit.version>
    <mockito.version>5.6.0</mockito.version>
</properties>
```

## 数据库设计
项目使用PostgreSQL数据库，主要表包括：
- **t_file_info**: 存储文件元数据信息
  - id: 主键
  - file_name: 文件名
  - file_path: 文件路径
  - file_size: 文件大小
  - file_type: 文件类型
  - upload_time: 上传时间
  - status: 文件状态

- **t_user**: 存储用户信息
  - id: 主键
  - username: 用户名
  - password: 密码(加密存储)
  - email: 电子邮箱
  - phone: 手机号
  - status: 用户状态
  - create_time: 创建时间
  - update_time: 更新时间

## 功能特性
1. **文件上传**:
   - 支持大文件上传
   - 支持断点续传
   - 支持文件加密和压缩

2. **文件下载**:
   - 支持断点续传
   - 支持文件权限控制

3. **文件管理**:
   - 文件列表查询
   - 文件详情查看
   - 文件删除

4. **用户管理**:
   - 用户注册和登录
   - 用户权限控制
   - 用户信息管理

## 测试覆盖
项目使用JUnit 5和Mockito进行测试：
- 单元测试覆盖所有工具类方法
- 集成测试验证文件上传下载流程
- 服务层测试验证业务逻辑

## 开发与部署
1. **开发环境**:
   - JDK 17
   - Maven 3.8+
   - PostgreSQL 14+
   - IDE (IntelliJ IDEA 推荐)

2. **部署步骤**:
   - 配置数据库连接
   - 编译打包: `mvn clean package`
   - 运行: `java -jar goodsop-server/target/goodsop-server-1.0.0-SNAPSHOT.jar`

## 注意事项
- 项目使用UTF-8编码
- 开发时遵循代码规范和最佳实践
- 提交代码前运行测试确保功能正常 